notifications:
  email: ellis.breen@couchbase.com
language: python
env:
  global:
  - CIBW_BUILD='cp3[5-8]-*'
  - CIBW_SKIP='*arm* *ppc* *s390* *aarch64* *i686*'
  - CIBW_BEFORE_BUILD="python3 -m pip install cmake"
jobs:
  include:
    # perform a linux build
  - services: docker
    # perform a linux ARMv8 build
    #- services: docker
    #  arch: arm64
    # perform a linux PPC64LE build
    #- services: docker
    #  arch: ppc64le
    # perform a linux S390X build
    #- services: docker
    #  arch: s390x
    # and a mac build
  - os: osx
    language: shell
    # and a windows build
  - os: windows
    language: shell
    before_install:
      - choco install python --version 3.8.0
      - choco install cmake
      - export PATH="/c/Python38:/c/Python38/Scripts:$PATH"
      # make sure it's on PATH as 'python3'
      - ln -s /c/Python38/python.exe /c/Python38/python3.exe

install:
- python3 -m pip install cibuildwheel==1.4.1
script:
- ls -alrt
- python3 -m cibuildwheel --output-dir wheelhouse
- echo `ls wheelhouse/`
deploy:
  provider: releases
  api_key:
    secure: WybaHr1WVx9/+6a3h5zT5bUmkNmVihKi1/mhSxdFmfHKHIQVcdBiNr1lbPKDh3ZnnxF/3TYadj2PDIqhtE50XDoGdmEFnDFH1VIvjYqffpzQ/+bmX/tY8SoSidyD8CejDmPkn7Wq6RUnouBdz6zn9HjQGigclCfO3dhF3Rr1k6AiV3oOppRFmPWWhBuciFnO25JyqOyPGfYt3kyK0IEgNHqxb0isdCOjnRuoGfMMLOaGgA2i7ffauGU3O+s8NIJHiWYWeiGBAoomdw6i6v2Mes5/U6ApJzXnDtIzqF/WLN6bg/5eTgVtpWBlr5q5CNR1Ycc8Um8JgT6dc3ZLlZ8fanH6Jtz/cv7iMvj+uAiBz90PBZk9niE6d3l5Uxpg0cBGRBGFK4Vnay7vaCVOaO4dx8iI6z4ljKhbvp71Tk+vgnROsKR3dIuWkm5dN/QxpDaYZBxgqeOvXt03GoliYzzzJiyqr/VkW2iymQri2YXTuTI7wbmOt/wr+z0f0NpgyHE5w5AlqG/fQG1BMCtPGuxHyidqBEKSplUX9JC9cZX8LYeFRJC3zuO/W7IjAGjhsA1//U3vn8BUGSBosbDweJBTf0lHIIIw/0cfkYzGryZnNMQBbvcPnyBbAbKEpQppTNtyG09VnUjl58euxkakRBqeBhAIvsj772YQ7NpVIP+s0IY=
  file: wheelhouse/*
  skip_cleanup: true
  on:
    repo: griels/couchbase-python-client-ng
    all_branches: true
